# üîÑ –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Backend

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞:
Backend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞. –ù—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ:

### –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Backend

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
pkill -9 -f "nest start"
pkill -9 -f "backend"
lsof -ti:3002 | xargs kill -9 2>/dev/null
```

### –®–∞–≥ 2: –û—á–∏—Å—Ç–∏—Ç—å dist (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
cd /Users/user/slava-larionov/site-base/backend
rm -rf dist
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å Backend
```bash
cd /Users/user/slava-larionov/site-base/backend
npm run start:dev
```

### –®–∞–≥ 4: –î–æ–∂–¥–∞—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
```
[Nest] ... LOG [NestApplication] Nest application successfully started
üöÄ Server is running on http://localhost:3002
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CMS endpoint:
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:3002/cms/watch-models
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
```json
[
  {
    "model_name": "TEST",
    "watch_model_name": "TEST",
    "watch_model_manufacturer": "TEST",
    "main_image": "http://localhost:3003/media/...",
    "choosen": false,
    "watch_sizes": [
      {"watch_size": "44", "choosen": false}
    ],
    "frame_colors": [
      {"color_name": "BLACK", "color_code": "#000000", "choosen": false}
    ]
  }
]
```

### –®–∞–≥ 6: –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä:
```
http://localhost:3002/configurator
```

–ú–æ–¥–µ–ª—å TEST –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è! üéâ

---

## üìù –ß—Ç–æ —è –∏–∑–º–µ–Ω–∏–ª:

1. ‚úÖ `next.middleware.ts` - –¥–æ–±–∞–≤–∏–ª –ø—Ä–æ–ø—É—Å–∫ `/cms` –ø—É—Ç–µ–π
2. ‚úÖ `cms.service.ts` - —É–ø—Ä–æ—Å—Ç–∏–ª query params –¥–ª—è Payload 2.x
3. ‚úÖ –ü–µ—Ä–µ–º–µ—Å—Ç–∏–ª middleware –≤ `/backend/src/` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

---

## üîç –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Backend –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É:
```bash
lsof -i :3002
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏:
```bash
# –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω Backend
# –°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ output
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ CMS —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
curl http://localhost:3003/api/watch-models
```

---

## ‚ú® –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:

–í–∞—à –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Payload CMS! 

–î–æ–±–∞–≤–ª—è–π—Ç–µ –º–æ–¥–µ–ª–∏ —á–∞—Å–æ–≤, —Ä–µ–º–µ—à–∫–∏ –∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ CMS Admin:
```
http://localhost:3003/admin
```

–ò –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ! üöÄ

